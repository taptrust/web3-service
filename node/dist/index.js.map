{"version":3,"sources":["../src/index.js"],"names":["express","require","bodyParser","account","relay","app","use","json","type","all","req","res","next","publicKey","query","username","createAccount","then","user","contractAddress","contract_address","catch","post","signature","action","txParams","relayMessage","result","getUsers","users","status","set","send","join","end","getUserNonce","address","nonce","console","log","get","port","process","env","PORT","listen"],"mappings":";;AAAA;;AAEA,IAAMA,UAAUC,QAAQ,SAAR,CAAhB;AACA,IAAMC,aAAaD,QAAQ,aAAR,CAAnB;AACA,IAAME,UAAUF,QAAQ,WAAR,CAAhB;;AAEA,IAAMG,QAAQH,QAAQ,SAAR,CAAd;AACA,IAAMI,MAAML,SAAZ;;AAEAK,IAAIC,GAAJ,CAAQJ,WAAWK,IAAX,CAAgB,EAAEC,MAAM,kBAAR,EAAhB,CAAR;;AAGAH,IAAII,GAAJ,CAAQ,gBAAR,EAA0B,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC5C,MAAIC,YAAYH,IAAII,KAAJ,CAAUD,SAA1B;AACA,MAAIE,WAAWL,IAAII,KAAJ,CAAUC,QAAzB;AACAZ,UAAQa,aAAR,CAAsBD,QAAtB,EAAgCF,SAAhC,EACGI,IADH,CACQ,UAACC,IAAD,EAAU;AACdP,QAAIJ,IAAJ,CAAS,EAACY,iBAAiBD,KAAKE,gBAAvB,EAAT;AACD,GAHH,EAIGC,KAJH,CAIST,IAJT;AAKD,CARD;;AAUAP,IAAIiB,IAAJ,CAAS,eAAT,EAA0B,UAACZ,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC5C,MAAIG,WAAWL,IAAII,KAAJ,CAAUC,QAAzB;AACA,MAAIQ,YAAYb,IAAII,KAAJ,CAAUS,SAA1B;AACA,MAAIJ,kBAAkBT,IAAII,KAAJ,CAAUK,eAAhC;AACA,MAAIK,SAASd,IAAII,KAAJ,CAAUU,MAAvB;AACA,MAAIC,WAAWf,IAAII,KAAJ,CAAUW,QAAzB;;AAEArB,QAAMsB,YAAN,CAAmBX,QAAnB,EAA6BQ,SAA7B,EAAwCJ,eAAxC,EAAyDK,MAAzD,EAAiEC,QAAjE,EACGR,IADH,CACQ,UAACU,MAAD,EAAY;AAChBhB,QAAIJ,IAAJ,CAAS,EAACoB,QAAQA,MAAT,EAAT;AACD,GAHH;AAID,CAXD;;AAaAtB,IAAII,GAAJ,CAAQ,WAAR,EAAqB,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACvCT,UAAQyB,QAAR,GACGX,IADH,CACQ,UAACY,KAAD,EAAW;AACflB,QACGmB,MADH,CACU,GADV,EAEGC,GAFH,CAEO,cAFP,EAEuB,YAFvB,EAGGC,IAHH,sBAG2BH,MAAMI,IAAN,CAAW,IAAX,CAH3B,EAIGC,GAJH;AAKD,GAPH,EAQGb,KARH,CAQST,IART;AASD,CAVD;;AAYAP,IAAII,GAAJ,CAAQ,eAAR,EAAyB,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC5CT,UAAQgC,YAAR,CAAqBzB,IAAII,KAAJ,CAAUsB,OAA/B,EACInB,IADJ,CACS,UAACoB,KAAD,EAAW;AACnBC,YAAQC,GAAR,CAAYF,KAAZ;AACA1B,QAAIJ,IAAJ,CAAS,EAAC,SAAS8B,KAAV,EAAT;AACG,GAJJ,EAKIhB,KALJ,CAKUT,IALV;AAMA,CAPD;;AAUAP,IAAImC,GAAJ,CAAQ,GAAR,EAAa,UAAC9B,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC7BD,MAAIJ,IAAJ,CAAS,EAAE,WAAW,aAAb,EAAT;AACH,CAFD;;AAKA,IAAMkC,OAAOC,QAAQC,GAAR,CAAYC,IAAZ,IAAoB,IAAjC;AACAvC,IAAIwC,MAAJ,CAAWJ,IAAX,EAAiB,YAAM;AACnBH,UAAQC,GAAR,oCAA6CE,IAA7C;AACH,CAFD","file":"index.js","sourcesContent":["// om namah shivay\r\n\r\nconst express = require('express');\r\nconst bodyParser = require('body-parser');\r\nconst account = require('./account');\r\n\r\nconst relay = require('./relay');\r\nconst app = express();\r\n\r\napp.use(bodyParser.json({ type: 'application/json' }))\r\n\r\n\r\napp.all('/createAccount', (req, res, next) => {\r\n  let publicKey = req.query.publicKey;\r\n  let username = req.query.username;\r\n  account.createAccount(username, publicKey)\r\n    .then((user) => {\r\n      res.json({contractAddress: user.contract_address});\r\n    })\r\n    .catch(next);\r\n});\r\n\r\napp.post('/relayMessage', (req, res, next) => {\r\n  let username = req.query.username;\r\n  let signature = req.query.signature;\r\n  let contractAddress = req.query.contractAddress;\r\n  let action = req.query.action;\r\n  let txParams = req.query.txParams;\r\n  \r\n  relay.relayMessage(username, signature, contractAddress, action, txParams)\r\n    .then((result) => {\r\n      res.json({result: result});\r\n    });\r\n});\r\n\r\napp.all('/getUsers', (req, res, next) => {\r\n  account.getUsers()\r\n    .then((users) => {\r\n      res\r\n        .status(200)\r\n        .set('Content-Type', 'text/plain')\r\n        .send(`Last 10 users:\\n${users.join('\\n')}`)\r\n        .end();\r\n    })\r\n    .catch(next);\r\n});\r\n\r\napp.all('/getUserNonce', (req, res, next) => {\r\n\taccount.getUserNonce(req.query.address)\r\n    .then((nonce) => {\r\n\t\tconsole.log(nonce);\r\n\t\tres.json({'nonce': nonce});\r\n    })\r\n    .catch(next);\r\n});\r\n\r\n\r\napp.get('/', (req, res, next) => {\r\n    res.json({ 'message': 'hello world' });\r\n});\r\n\r\n\r\nconst port = process.env.PORT || 8080;\r\napp.listen(port, () => {\r\n    console.log(`Node server listening on port ${port}`);\r\n});\r\n"]}